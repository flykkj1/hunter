-- Configurações do personagem Rank ??? Hunter
local playerSettings = {
    movementSpeed = {enabled = true, value = 100, description = "Velocidade de movimento", min = 16, max = 200},
    skillCooldowns = {
        AstralCut = {enabled = true, value = 0.1, description = "Cooldown de Astral Cut", min = 0, max = 10},
        AstralBreak = {enabled = true, value = 0.1, description = "Cooldown de Astral Break", min = 0, max = 10},
        AsteriskSlash = {enabled = true, value = 0.1, description = "Cooldown de Asterisk Slash", min = 0, max = 10},
        AstralLine = {enabled = true, value = 0.1, description = "Cooldown de Astral Line", min = 0, max = 10}
    }
}

-- Função para aplicar as configurações no personagem
local function applyCharacterSettings(player)
    local character = player.Character
    if not character or not character:FindFirstChild("Humanoid") then
        return
    end

    local humanoid = character:FindFirstChild("Humanoid")
    
    -- Alterar a velocidade de movimento
    if playerSettings.movementSpeed.enabled then
        humanoid.WalkSpeed = playerSettings.movementSpeed.value
    end

    -- Alterar o cooldown das habilidades
    local replicatedStorage = game:GetService("ReplicatedStorage")
    local skills = replicatedStorage:FindFirstChild("Skills")
    if skills then
        for _, skill in pairs(skills:GetChildren()) do
            if skill.Name == "AstralCut" and playerSettings.skillCooldowns.AstralCut.enabled then
                local cooldown = skill:FindFirstChild("Cooldown")
                if cooldown then
                    cooldown.Value = playerSettings.skillCooldowns.AstralCut.value
                end
            elseif skill.Name == "AstralBreak" and playerSettings.skillCooldowns.AstralBreak.enabled then
                local cooldown = skill:FindFirstChild("Cooldown")
                if cooldown then
                    cooldown.Value = playerSettings.skillCooldowns.AstralBreak.value
                end
            elseif skill.Name == "AsteriskSlash" and playerSettings.skillCooldowns.AsteriskSlash.enabled then
                local cooldown = skill:FindFirstChild("Cooldown")
                if cooldown then
                    cooldown.Value = playerSettings.skillCooldowns.AsteriskSlash.value
                end
            elseif skill.Name == "AstralLine" and playerSettings.skillCooldowns.AstralLine.enabled then
                local cooldown = skill:FindFirstChild("Cooldown")
                if cooldown then
                    cooldown.Value = playerSettings.skillCooldowns.AstralLine.value
                end
            end
        end
    end
end

-- Função para alterar as configurações dinamicamente
local function updateSettings(setting, value)
    if playerSettings[setting] then
        playerSettings[setting].enabled = value
        print("Configuração alterada: " .. setting .. " = " .. tostring(value))
        
        -- Aplicar as novas configurações imediatamente
        local player = game.Players.LocalPlayer
        applyCharacterSettings(player)
    elseif playerSettings.skillCooldowns[setting] then
        playerSettings.skillCooldowns[setting].enabled = value
        print("Configuração alterada: " .. setting .. " = " .. tostring(value))

        -- Aplicar as novas configurações de cooldown
        local player = game.Players.LocalPlayer
        applyCharacterSettings(player)
    else
        warn("Configuração não válida!")
    end
end

-- Função para criar uma tabela de opções movível e minimizável
local function createOptionsGUI(player)
    -- Criar a GUI principal
    local screenGui = Instance.new("ScreenGui")
    screenGui.Parent = player:WaitForChild("PlayerGui")

    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(0, 300, 0, 400)
    frame.Position = UDim2.new(0.5, -150, 0.5, -200)
    frame.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
    frame.Parent = screenGui

    -- Criar o cabeçalho da tabela com botão de minimizar
    local header = Instance.new("Frame")
    header.Size = UDim2.new(1, 0, 0, 25)
    header.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    header.Parent = frame

    local minimizeButton = Instance.new("TextButton")
    minimizeButton.Size = UDim2.new(0, 30, 1, 0)
    minimizeButton.Position = UDim2.new(1, -30, 0, 0)
    minimizeButton.Text = "_"
    minimizeButton.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
    minimizeButton.Parent = header

    local isMinimized = false
    minimizeButton.MouseButton1Click:Connect(function()
        isMinimized = not isMinimized
        frame.Size = isMinimized and UDim2.new(0, 300, 0, 30) or UDim2.new(0, 300, 0, 400)
        for _, child in pairs(frame:GetChildren()) do
            if child ~= header then
                child.Visible = not isMinimized
            end
        end
        minimizeButton.Text = isMinimized and "+" or "_"
    end)

    local uiListLayout = Instance.new("UIListLayout")
    uiListLayout.Parent = frame

    -- Criar botões dinâmicos para cada configuração
    local movementButton = Instance.new("TextButton")
    movementButton.Size = UDim2.new(0, 250, 0, 30)
    movementButton.Text = playerSettings.movementSpeed.enabled and "Ativar Velocidade" or "Desativar Velocidade"
    movementButton.BackgroundColor3 = playerSettings.movementSpeed.enabled and Color3.fromRGB(0, 255, 0) or Color3.fromRGB(255, 0, 0)
    movementButton.Parent = frame

    movementButton.MouseButton1Click:Connect(function()
        playerSettings.movementSpeed.enabled = not playerSettings.movementSpeed.enabled
        movementButton.Text = playerSettings.movementSpeed.enabled and "Ativar Velocidade" or "Desativar Velocidade"
        movementButton.BackgroundColor3 = playerSettings.movementSpeed.enabled and Color3.fromRGB(0, 255, 0) or Color3.fromRGB(255, 0, 0)
        applyCharacterSettings(player)
    end)

    -- Criar botões para o cooldown das skills
    for skillName, cooldownConfig in pairs(playerSettings.skillCooldowns) do
        local button = Instance.new("TextButton")
        button.Size = UDim2.new(0, 250, 0, 30)
        button.Text = cooldownConfig.enabled and "Ativar " .. skillName or "Desativar " .. skillName
        button.BackgroundColor3 = cooldownConfig.enabled and Color3.fromRGB(0, 255, 0) or Color3.fromRGB(255, 0, 0)
        button.Parent = frame

        button.MouseButton1Click:Connect(function()
            cooldownConfig.enabled = not cooldownConfig.enabled
            button.Text = cooldownConfig.enabled and "Ativar " .. skillName or "Desativar " .. skillName
            button.BackgroundColor3 = cooldownConfig.enabled and Color3.fromRGB(0, 255, 0) or Color3.fromRGB(255, 0, 0)
            applyCharacterSettings(player)
        end)
    end
end

-- Função para aplicar as configurações iniciais ao jogador
local function initializeSettings(player)
    -- Aplicar configurações iniciais
    applyCharacterSettings(player)

    -- Criar a interface de opções
    createOptionsGUI(player)
end

-- Inicializar as configurações e a interface quando o jogador entra
local player = game.Players.LocalPlayer
initializeSettings(player)
